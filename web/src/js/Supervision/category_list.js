$(function(){function t(t){a.html(t.data[2]),o.siblings(".panel-body").slideToggle();var e=list_categories.row.add([t.data[1].order,t.data[1].name,t.data[1].groupCategory,t.data[1].taxBe,t.data[1].taxLux,t.data[1].eligible,t.data[1].btn]).draw().node();$(e).attr("id",t.data[1].id)}var a=$("#AddCategoryForm"),e=$("#modal-category-added"),o=$(".filter-zone .panel-heading");list_categories=initSimpleDataTable("#categories_list_table",{rowId:"category",aoColumnDefs:[{bSortable:!1,aTargets:[5]},{sClass:"actions-btn",aTargets:[5]}]}),$(document).on("click","#plus-category-button",function(o){loader.show(),ajaxCall({url:Routing.generate("categories_list"),method:POST,data:a.serialize()},function(o){void 0===o.errors&&void 0===o.formError?(e.html(o.data[0]),showDefaultModal(Translator.trans("category.list.add_success"),e.html()),t(o)):(a.html(o.formError[0]),$("input").each(function(){""!=$(this).val()&&"category[helpCmd]"!=$(this).attr("name")&&$("label[for='"+$(this).attr("id")+"']").addClass("active")})),loader.hide()})}),$(document).on("click","#edit-category-button",function(o){loader.show(),category=a.attr("class"),ajaxCall({url:Routing.generate("categories_list",{category:category}),method:POST,data:a.serialize()},function(o){void 0===o.errors&&void 0===o.formError?(list_categories.row($("#"+category)).remove().draw(),e.html(o.data[0]),showDefaultModal(Translator.trans("category.list.edit_success"),e.html()),t(o),$(".panel-heading").html('<span class="glyphicon glyphicon-plus"></span> '+Translator.trans("category.list.add")),a.removeAttr("class")):(a.html(o.formError[0]),$("input").each(function(){""!=$(this).val()&&"category[eligible]"!=$(this).attr("name")&&$("label[for='"+$(this).attr("id")+"']").addClass("active")})),loader.hide()}),loader.hide()}),$(document).on("click",".glyphicon-edit",function(){loader.show();var t=$(this).parentsUntil("tbody","tr").attr("id");ajaxCall({url:Routing.generate("categories_list",{category:t}),dataType:"json"},function(e){"undefined"!=typeof e.data&&0!=e.data.length?($(".panel-heading").html('<span class="glyphicon glyphicon-edit"></span> '+Translator.trans("category.list.edit")),a.html(e.data[0]),a.removeAttr("class"),a.addClass(t),$("input").each(function(){""!=$(this).val()&&"category[helpCmd]"!=$(this).attr("name")&&$("label[for='"+$(this).attr("id")+"']").addClass("active")}),o.siblings(".panel-body").is(":hidden")&&o.siblings(".panel-body").slideToggle(),$("html,body").animate({scrollTop:0},1200)):Notif.alert(Translator.trans("error.general.internal"),500,3e3),loader.hide()})}),$(document).on("click",".detail-btn",function(t){var a=$(this).parentsUntil("tbody","tr").attr("id");loader.show(),ajaxCall({url:Routing.generate("category_detail",{category:a}),type:"json"},function(t){showDefaultModal(Translator.trans("category.list.details"),t.data),loader.hide()})}),$(document).on("click",".glyphicon-remove",function(){var t=$(this).parentsUntil("tbody","tr").attr("id");loader.show(),ajaxCall({url:Routing.generate("delete_category",{category:t}),dataType:"json"},function(t){if("undefined"!=typeof t.errors&&t.errors.length>0){var a="<div class='alert alert-danger'>"+Translator.trans(t.errors[0])+"</div>";showDefaultModal(Translator.trans("category.list.delete"),a)}else showDefaultModal(Translator.trans("category.list.delete"),t.html);loader.hide()})}),$(document).on("click","#btn-cancel-edit",function(){var t="<h2>"+Translator.trans("cancel.confirmation.content")+"</h2>",a="<div class='row'><div class='col col-lg-12 col-md-12 col-xs-12 col-sm-12' style='text-align: right'><button type='button' id='btn-yes-cancel-edit' class='btn waves-effect waves-light blue' data-dismiss='modal'>"+Translator.trans("yes_confirm")+"</button><button type='button' class='btn btn-cancel' data-dismiss='modal' style='margin-right: 10px'>"+Translator.trans("btn.close")+"</button></div>";showDefaultModal(Translator.trans("cancel.confirmation.title"),t,a)}),$(document).on("click","#btn-yes-cancel-edit",function(){loader.show(),ajaxCall({url:Routing.generate("categories_list")},function(t){void 0===t.errors?(a.html(t.data[0]),o.siblings(".panel-body").slideToggle(),$(".panel-heading").html('<span class="glyphicon glyphicon-plus"></span> '+Translator.trans("category.list.add"))):Notif.alert(Translator.trans("error.general.internal"),500,3e3)}),loader.hide()}),$("#export-btn").on("click",function(){submitExportDocumentFile(".filter-zone",list_categories,Routing.generate("categories_list_export"))})});