$(function(){var t=initSimpleDataTable("#envelopes_table"),a=$("#number-envelope"),e=$("#deposit_ticket_totalAmount");$(document).on("click","#btn-validate",function(){""!=$("#deposit_ticket_sousType").val()?0!=a.val()?bootbox.confirm({title:Translator.trans("deposit.envelope_ticket.validate"),message:Translator.trans("deposit.envelope_ticket.validate_message",{nbre:a.val(),amount:e.val()}),closeButton:!1,buttons:{cancel:{label:Translator.trans("keyword.no"),className:"btn btn-cancel btn-icon margin-right-left"},confirm:{label:Translator.trans("keyword.yes"),className:"btn btn-validate btn-icon margin-right-left"}},callback:function(t){t&&(loader.block(),ajaxCall({method:"POST",url:Routing.generate("deposit_ticket",{}),data:$("#deposit-form").serialize()},function(t){void 0===t.errors?showDefaultModal(t.data.header,t.data[0],t.data.footer,"98%","",!1):$("#form-container").html(t.data[0])},null,function(){loader.unblock()}))}}):$.notify(Translator.trans("deposit.message.no_envelope"),{status:"danger"}):""==$("#deposit_ticket_sousType").val()&&$.notify(Translator.trans("deposit.message.choose_type"),{status:"danger"})}),$(document).on("change","#deposit_ticket_sousType",function(){loader.block(),ajaxCall({method:"GET",url:Routing.generate("deposit_ticket",{}),data:$("#deposit-form").serialize()},function(o){void 0===o.errors&&(t.clear(),t.draw(),null!=o.data.affiliateCode?($.each(o.data.envelopes,function(a,e){t.row.add([e.number,e.reference,e.amount,e.sousType,e.owner,e.status,e.createdAt]).draw().node()}),a.val(o.data.envelopes.length),$("#total-amount-div").html(floatToString(o.data.total)+"&euro;"),$("#deposit_ticket_affiliateCode").val(o.data.affiliateCode),e.val(o.data.total)):(a.val(0),$("#total-amount-div").html(""),$("#deposit_ticket_affiliateCode").val("")),$("#affiliate-code").html(o.data.affiliateCode))},null,function(){loader.unblock()})})});