var calculateExchangeFundTotal=null;$(function(){$(document).on("focus",".exchange_fund_rate_select",function(){$(this).attr("data-selected",!0);var t=$(".exchange_fund_rate_select"),e=$(this).find("option"),n=($(this),{});t.each(function(t,e){"true"!==$(e).attr("data-selected")&&(n[$(this).find("option:selected").text()]=!0)}),e.each(function(t,e){""!==$(e).text()&&(void 0!==n[$(e).text()]?$(e).attr("disabled","disabled"):$(e).removeAttr("disabled"))})}),calculateExchangeFundTotal=function(){if(countingIsValid){var t=0,e=$("#exchangeContainer").find(".exchange_row"),n=/\(([^)]+)\)/;e.each(function(e,a){var c=$(a).find(".exchange_quantity").first().val(),o=0,u=$(a).find(".exchange_fund_rate_select").first();""!=u.val()&&(o=n.exec($(u).find("option:selected").text())[1]);var i=$(a).find(".total_span").first(),l=parseFloat(c)*parseFloat(o);t+=l,i.text(floatToString(l))}),$(".total_exchange_fund").text(floatToString(t)),processSummaryCalculation()}},$(document).on("keyup",".exchange_quantity",function(){calculateExchangeFundTotal()}),$(document).on("focusout",".exchange_fund_rate_select",function(){$(this).attr("data-selected",!1)}),$(document).on("change",".exchange_fund_rate_select",function(){$(this).attr("data-selected",!1);var t=$($(this).closest(".exchange_row")).find(".unit_value").first(),e=$(this).find("option:selected").text(),n=/\(([^)]+)\)/,a=0;a=parseFloat(n.exec(e)[1]),$(t).val(floatToString(a)),calculateExchangeFundTotal()}),$(document).on("click","#addExchange",function(){var t=$("#exchangeContainer"),e=parseInt($(this).attr("data-count"));$(this).attr("data-count",e+1);var n=$(this).data("prototype").replace(/__name__/g,e).replace(/__total__/g,"0,00");t.append($(n))}),$(document).on("focus",".foreign_currency_amount",function(){var t="foreign_currency_amount",e=$(this);shortcutController.add(KEY_ENTER,null,null,function(){var t=$($($(e).closest(".row").next(".row")[0]).find(".foreign_currency_amount")[0]);t.focus(),t.select()},t);$(e).focusout(function(){$(document).unbind("keyup."+t)})}),$(document).on("focus",".exchange_quantity",function(){var t="exchange_fund_next_cell",e=$(this);shortcutController.add(KEY_ENTER,null,null,function(){var t=$($($(e).closest("tr").next("tr")[0]).find(".exchange_quantity")[0]);t.focus(),t.select()},t);$(e).focusout(function(){$(document).unbind("keyup."+t)})})});