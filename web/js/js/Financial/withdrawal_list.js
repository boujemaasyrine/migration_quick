$(function(){function t(t,e){var a=new Date;a.setFullYear(t.substr(6,4)),a.setMonth(t.substr(3,2)),a.setDate(t.substr(0,2)),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);var n=a.getTime(),r=new Date;r.setFullYear(e.substr(6,4)),r.setMonth(e.substr(3,2)),r.setDate(e.substr(0,2)),r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0);var o=r.getTime();n>o?($(".date-compare").remove(),$(".endDate").append('<div class="alert alert-danger form-error date-compare" role="alert"><span class="glyphicon glyphicon-warning-sign"></span> '+Translator.trans("portion_control.validation.start_date_must_be_before_end_dat")+"<br></div>")):$(".date-compare").remove()}withdrawals=initSimpleDataTable("#withdrawals_table",{lengthChange:!0,rowId:"id",processing:!0,serverSide:!0,searching:!1,order:[[2,"desc"]],columnDefs:[{targets:[5],orderable:!1},{width:"13%",aTargets:[5]}],columns:[{data:"responsible"},{data:"member"},{data:"date"},{data:"amount"},{data:"status"},{data:"envelope",className:"actions-btn",render:function(t,e,a){if("true"==t){var n="<button type='button' class='btn blue  detail-btn'><span class='glyphicon glyphicon-eye-open'></span> "+Translator.trans("btn.view_envelope")+"</button>";return n}return Translator.trans("fund_management.withdrawal.list.without_envelope")}}],ajax:{url:Routing.generate("withdrawals_json_list"),data:function(t){return t.criteria=serializeArrayToObjectByKey($("#filterWithdrawalForm").serializeArray(),"name"),t},type:"post"}}),$(document).on("click",".detail-btn",function(){loader.show();var t=$(this).parentsUntil("tbody","tr").attr("id");ajaxCall({url:Routing.generate("withdrawal_detail",{withdrawal:t}),type:"json"},function(t){showDefaultModal(Translator.trans("fund_management.withdrawal.list.envelope_details"),t.data)}),loader.hide()}),$("#reset-filter").on("click",function(){resetFilter($(".filter-zone")),withdrawals.ajax.reload()}),$(document).on("click","#export-btn",function(){submitExportDocumentFile(".filter-zone",withdrawals,Routing.generate("withdrawals_json_list",{download:1}))}),$(document).on("click","#print-btn",function(){submitExportDocumentFile(".filter-zone",withdrawals,Routing.generate("withdrawals_json_list",{pdf:1}))}),$(document).on("click",".glyphicon-edit",function(){var t=$(this).parentsUntil("tbody","tr").attr("id");window.location.href=Routing.generate("withdrawal_entry",{withdrawal:t})}),$(document).on("change","#withdrawal_search_endDate",function(){var e=$("#withdrawal_search_startDate").val(),a=$(this).val();""!=e&&null!=e&&""!=a&&null!=a?t(e,a):$(".date-compare").remove()}),$(document).on("change","#withdrawal_search_startDate",function(){var e=$(this).val(),a=$("#withdrawal_search_endDate").val();""!=e&&null!=e&&""!=a&&null!=a?t(e,a):$(".date-compare").remove()}),$(document).on("click",".btn-refresh",function(){location.reload()})});