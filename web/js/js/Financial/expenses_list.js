$(function(){expenses=initSimpleDataTable("#expenses_table",{rowId:"id",processing:!0,serverSide:!0,searching:!1,columnDefs:[{targets:[0],orderable:!1},{targets:[1],orderable:!1},{targets:[2],orderable:!1},{targets:[3],orderable:!1},{targets:[4],orderable:!1},{width:"10%",aTargets:[4]}],columns:[{data:"reference"},{data:"label"},{data:"owner"},{data:"amount"},{className:"actions-btn",render:function(e,t,a){var n="<button type='button' class='btn btn-view btn-icon detail-btn'> "+Translator.trans("btn.view_details")+"</button>";return n}}],ajax:{url:Routing.generate("expenses_json_list"),data:function(e){return e.criteria=serializeArrayToObjectByKey($("#filterExpenseForm").serializeArray(),"name"),e},type:"post"},rowCallback:function(e,t,a){$(e).attr("data-class",t.dataClass),$(e).attr("data-value",t.dataValue),$(e).attr("class","hidden")},fnDrawCallback:function(e){var t=$("#expenses_table > tbody > tr"),a=[];t.each(function(){var e=$(this);void 0!=e.attr("data-class")&&a.indexOf(e.attr("data-class"))==-1&&(a.push(e.attr("data-class")),e.before('<tr style="cursor:pointer; background-color: #E4D9C3 !important;" data-name="'+e.attr("data-value")+'" class="groupe-date"><td colspan="5""><span class="glyphicon glyphicon-plus"></span><b> '+e.attr("data-class")+"</b></td></tr>"))})}}),$(document).on("click",".detail-btn",function(){loader.show();var e=$(this).parentsUntil("tbody","tr").attr("id");ajaxCall({url:Routing.generate("expense_detail",{expense:e}),type:"json"},function(e){var t;t=1==e.table?"90%":"",showDefaultModal(Translator.trans("expense.list.expense_details"),e.data,e.dataFooter,t)}),loader.hide()}),$("#reset-filter").on("click",function(){resetFilter($(".filter-zone")),expenses.ajax.reload()}),$("#export-btn").on("click",function(){submitExportDocumentFile(".filter-zone",expenses,Routing.generate("expenses_json_list",{download:1}))}),$("#download-btn").on("click",function(){submitExportDocumentFile(".filter-zone",expenses,Routing.generate("expenses_json_list",{download:2}))}),$(document).on("click",".groupe-date",function(){var e=$(this).attr("data-name");$("span:first",this).hasClass("glyphicon-plus")?$("span:first",this).removeClass("glyphicon-plus").addClass("glyphicon-minus"):$("span:first",this).removeClass("glyphicon-minus").addClass("glyphicon-plus"),$("#expenses_table > tbody  > tr").each(function(){$(this).attr("data-value")==e&&$(this).hasClass("hidden")?$(this).removeClass("hidden"):$(this).attr("data-value")==e&&$(this).addClass("hidden")})}),$(document).on("change","#expense_search_group",function(){var e=$(this).val(),t=$("#expense_search_label");loader.show(),ajaxCall({url:Routing.generate("expense_group_labels",{group:e}),method:POST},function(e){$("#expense_search_label option:gt(0)").remove(),$.each(e.labels,function(e,a){t.append($("<option></option>").attr("value",e).text(a))}),sortSelect(t)}),loader.hide()})});