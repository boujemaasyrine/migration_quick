var productSoldDatatable=null;$(function(){productSoldDatatable=initSimpleDataTable("#product_sold_table",{searching:!0,processing:!0,serverSide:!0,ajax:{url:Routing.generate("supervision_product_sold_list_export"),data:function(t){return t.criteria=serializeArrayToObjectByKey($("#productSoldFilterForm").serializeArray(),"name"),t},type:"post"},columns:[{data:"codePlu"},{data:"name"},{data:"type",render:function(t){return Translator.trans(t)}},{data:"active",render:function(t){return 1==t?'<div class="label label-success" style="color:#fff !important; margin: 0">'+Translator.trans("status.active")+"</div>":'<div class="label label-danger" style="color:#fff !important; margin: 0">'+Translator.trans("status.inactive")+"</div>"}},{data:"dateSynchro"},{data:"lastDateSynchro"},{data:null,orderable:!1,render:function(t){var a=$("#product_sold_table").attr("data-template"),r=void 0===t.restaurants?[]:JSON.parse(t.restaurants),e="";return r.forEach(function(t,a){var r=t.name.replace(/\"/g,"&quot;");r=r.replace(/\'/g,"&quot;");var o=t.code;e+="<li>- "+o+"- "+r+"</li>"}),a=a.replace(/_id_/g,t.id),a=a.replace(/_product_name_/g,t.name),a=a.replace(/_restaurants_/g,e)},targets:0}],drawCallback:function(){$('[data-toggle="tooltip"]').tooltip()}}),$(document).on("click",".reload-sold-item",function(){var t=$(this).attr("data-item"),a=$(this).attr("data-elligible-restaurans"),r=$(this).attr("data-product-name");bootbox.confirm({title:Translator.trans("product.synchronization_title"),message:Translator.trans("product.synchronization_message",{product:r,restaurants:a}),closeButton:!1,buttons:{cancel:{label:Translator.trans("keyword.no"),className:"btn btn-cancel btn-icon margin-right-left"},confirm:{label:Translator.trans("keyword.yes"),className:"btn btn-validate btn-icon margin-right-left pull-right"}},callback:function(a){a&&(loader.show(),ajaxCall({url:Routing.generate("force_synchronize_sold_product",{productSold:t}),type:"json"},function(t){void 0!==t.data.sucess&&location.reload(),loader.hide()}))}})}),$("#reset-filter").on("click",function(){resetFilter($("#filter-zone-search")),productSoldDatatable.ajax.reload()}),$("#export-btn").on("click",function(){submitExportDocumentFile(".filter-zone",productSoldDatatable,Routing.generate("supervision_product_sold_list_export",{download:1}))})});