$(function(){function e(e){return e}initProductAutocomplete=function(t){var a=$("#searchByCode");a.autocomplete({autoFill:!0,appendTo:$(t),source:function(t,a){var r=t.term;return e(r)in productCache?void a(productCache[e(r)]):void ajaxCall({url:Routing.generate("find_active_products",{term:r,selectedType:cibledProducts}),method:GET},function(t){void 0==t.errors&&(productCache[e(r)]=$.map(t.data[0],function(e){return{id:e.id,name:e.name,label:e.codePlu+"- "+e.name,value:e.codePlu+"- "+e.name,codePlu:e.codePlu}}),a(productCache[e(r)]))},null,null,!0)},select:function(e,t){var a=t.item.id,r=!1;if($(".product_id").each(function(){r||$(this).next("input").val()==a&&(r=!0)}),r)Notif.alert(Translator.trans("sheet_model.notification.item_already_exist",{product_name:t.item.name}));else{var o=$("#containerSheetModelLines"),n=parseInt(o.attr("data-count"));o.attr("data-count",n+1);var c=o.data("prototype").replace(/_line_number_/g,n).replace(/_id_product_/g,t.item.id).replace(/_ref_product_/g,t.item.codePlu).replace(/_label_product_/g,t.item.name).replace(/_order_in_sheet_/g,n).replace(/_num_/g,sheetModelFormTable.data().length);sheetModelFormTable.row.add($(c)).draw(),$("#searchByProductName").val(t.item.name)}return $(this).val(""),!1}});var r=$("#searchByProductName");r.autocomplete({autoFill:!0,appendTo:$(t),source:function(t,a){var r=t.term;return e(r)in productCache?void a(productCache[e(r)]):void ajaxCall({url:Routing.generate("find_active_products",{term:r,selectedType:cibledProducts,filterSecondary:"true"}),method:GET},function(t){void 0==t.errors&&(productCache[e(r)]=$.map(t.data[0],function(e){return{id:e.id,name:e.name,label:e.name,value:e.name,codePlu:e.codePlu}}),a(productCache[e(r)]))},null,null,!0)},select:function(e,t){var a=$("#containerSheetModelLines"),r=parseInt(a.attr("data-count"));a.attr("data-count",r+1);var o=!1,n=sheetModelFormTable.rows().data();if(void 0!==n[0]&&void 0!==n[0].length)for(var c=0;c<n[0].length;c++){var d=$(n[0][c]),l=$(d[1]).val();if(parseInt(l)===parseInt(t.item.id)){o=!0;break}}if(o)Notif.alert(Translator.trans("sheet_model.notification.item_already_exist",{product_name:t.item.name}));else{var i=a.data("prototype").replace(/_line_number_/g,r).replace(/_id_product_/g,t.item.id).replace(/_ref_product_/g,t.item.codePlu).replace(/_label_product_/g,t.item.name).replace(/_num_/g,sheetModelFormTable.data().length).replace(/_order_in_sheet_/g,r);sheetModelFormTable.row.add($(i)).draw(),$("#searchByCode").val(t.item.codePlu),Notif.success(Translator.trans("sheet_model.notification.item_selected_with_success",{product_name:t.item.name}))}}})}});